<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script></script><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3"><link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222"><meta name="keywords" content="Hexo,环境搭建,TravisCI,"><link rel="alternate" href="/atom.xml" title="mtianyan's blog" type="application/atom+xml"><meta name="description" content="优秀的程序员都是不用持续集成的    前几天我面试了一个码农，连续几个专业问题他都没答上来。尴尬之余，我问它：「你没有什么理想吗？你现在最渴望的事情是什么？」码农转悠着大眼睛，不假思索道：「做一个持续集成的自动部署！」真没想到在面试中居然还有这种操作。我问为什么这能成为现阶段最渴望的事情。他反问「你就没有改动代码频繁，deploy无数次到崩溃的夜晚吗？寂寞长夜，总想好好专心写写博客，宽慰下自己啊。"><meta name="keywords" content="Hexo,环境搭建,TravisCI"><meta property="og:type" content="article"><meta property="og:title" content="用TravisCI持续集成自动部署Hexo博客的个人实践"><meta property="og:url" content="http://blog.mtianyan.cn/post/90a759d5.html"><meta property="og:site_name" content="mtianyan&#39;s blog"><meta property="og:description" content="优秀的程序员都是不用持续集成的    前几天我面试了一个码农，连续几个专业问题他都没答上来。尴尬之余，我问它：「你没有什么理想吗？你现在最渴望的事情是什么？」码农转悠着大眼睛，不假思索道：「做一个持续集成的自动部署！」真没想到在面试中居然还有这种操作。我问为什么这能成为现阶段最渴望的事情。他反问「你就没有改动代码频繁，deploy无数次到崩溃的夜晚吗？寂寞长夜，总想好好专心写写博客，宽慰下自己啊。"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180104/9G63Bg3iaa.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180104/A9fAbhaL19.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/l1HkKEIcjh.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180104/k9k94G963L.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180104/3bjG0jfmc4.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180104/cgGbjIaA75.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180104/BGK3J1449G.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180104/BcCm1JgH4B.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/k5jdFhABe3.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/i8KFECDafl.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/Gjb2cI7287.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/bl7HDma64l.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/j9fA5GhEfk.png?imageslim"><meta property="og:updated_time" content="2018-01-16T16:33:05.295Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="用TravisCI持续集成自动部署Hexo博客的个人实践"><meta name="twitter:description" content="优秀的程序员都是不用持续集成的    前几天我面试了一个码农，连续几个专业问题他都没答上来。尴尬之余，我问它：「你没有什么理想吗？你现在最渴望的事情是什么？」码农转悠着大眼睛，不假思索道：「做一个持续集成的自动部署！」真没想到在面试中居然还有这种操作。我问为什么这能成为现阶段最渴望的事情。他反问「你就没有改动代码频繁，deploy无数次到崩溃的夜晚吗？寂寞长夜，总想好好专心写写博客，宽慰下自己啊。"><meta name="twitter:image" content="http://myphoto.mtianyan.cn/blog/180104/9G63Bg3iaa.png?imageslim"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.3",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://blog.mtianyan.cn/post/90a759d5.html"><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement("script"),n=t.getElementsByTagName("script")[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,0,("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/0f81ff2f.js","daovoice"),daovoice("init",{app_id:"e28768be"}),daovoice("update")</script><title>用TravisCI持续集成自动部署Hexo博客的个人实践 | mtianyan's blog</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?415372bd35fec36f7558dd96b48ec03f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/mtianyan" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">mtianyan's blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">天涯明月笙的博客小站(Github托管)</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br> 公益404</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://blog.mtianyan.cn/post/90a759d5.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="mtianyan"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="mtianyan's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">用TravisCI持续集成自动部署Hexo博客的个人实践</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-04T20:21:45+08:00">2018-01-04</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/运维环境配置/" itemprop="url" rel="index"><span itemprop="name">运维环境配置</span></a></span></span> <span id="/post/90a759d5.html" class="leancloud_visitors" data-flag-title="用TravisCI持续集成自动部署Hexo博客的个人实践"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">热度&#58;</span><span class="leancloud-visitors-count"></span> <span>℃</span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">2,522</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">10</span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote class="blockquote-center"><p>优秀的程序员都是不用持续集成的</p></blockquote><div class="note"><p> 前几天我面试了一个码农，连续几个专业问题他都没答上来。<br>尴尬之余，我问它：「你没有什么理想吗？你现在最渴望的事情是什么？」<br>码农转悠着大眼睛，不假思索道：「做一个持续集成的自动部署！」<br>真没想到在面试中居然还有这种操作。<br>我问为什么这能成为现阶段最渴望的事情。<br>他反问「你就没有改动代码频繁，deploy无数次到崩溃的夜晚吗？寂寞长夜，总想好好专心写写博客，宽慰下自己啊。」<br>今天我就要做为一个不优秀的程序员使用持续集成。</p></div><a id="more"></a><p>观看本教程的前置条件：</p><ol><li>已经配置好了hexo博客。拥有一个仓库如：<code>mtianyan.github.io</code>\</li><li>已经将博客的源码也<code>push</code>到了一个仓库如：<code>hexoBlog-Github</code></li><li>已经配置了使用gulp进行博文压缩。</li></ol><p>参考：推荐观看我的博文《Hexo+Next主题搭建博客安装美化及SEO优化指南》<code>中将博客源码备份到github或码云</code> 与 <code>使用gulp进行博文压缩</code></p><p>完成上述前置条件，虽然不是必须的，但是可以与我保持一致。减少错误。</p><p>部分内容转载来源参考博客: <a href="https://www.karlzhou.com/2016/05/28/travis-ci-deploy-blog/" target="_blank" rel="noopener">https://www.karlzhou.com/2016/05/28/travis-ci-deploy-blog/</a></p><p>个人对上面博客做了新版本的修订。我最近每天改动博客的内容。一会目录有问题，一会改了站点参数，主题参数，出现Bug,<br>不停的提交快崩溃了：寂寞长夜，总想好好专心写写博客，宽慰下自己啊。</p><p>本文是一次在这个命题下的个人实践记录：大部分文字转载自参考博客</p><p>通常更新一篇Hexo博客文章，基本流程是：</p><ol><li>本地新建post页面</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo n travis-ci-deploy-blog</span><br><span class="line">INFO  Created: e:\WORK\GitHub\think-diff.me.source\source\_posts\travis-ci-deploy-blog.md</span><br></pre></td></tr></table></figure><ol><li>在文本编辑器里用<code>markdown</code>语法编辑新建页面</li><li>本地生成public文件：<code>hexo g &amp;&amp; gulp</code></li><li>启动本地测试web server：<code>hexo s --debug</code></li><li>浏览器打开<code>http://localhost:4000/</code>, 浏览生成文章</li><li>如果满意，即可部署到Github存放page仓库里：<code>hexo d</code></li></ol><p>本文主要介绍如何利用<code>TravisCI</code>自动完成第<code>3-6</code>步.</p><h1 id="What-is-Travis-CI"><a href="#What-is-Travis-CI" class="headerlink" title="What is Travis CI?"></a>What is Travis CI?</h1><p>Travis CI</p><p><img src="http://myphoto.mtianyan.cn/blog/180104/9G63Bg3iaa.png?imageslim" alt="mark"></p><p><code>CI(Continuous Integration)</code>翻译为<code>持续集成</code>。<code>Travis CI</code>是一个提供<strong>持续集成功能</strong>的平台，在<code>Github</code>上，可以添加<code>Travis CI</code>，当有<code>code push</code>时候，会推送通知到<code>Travis</code>，根据设置的脚本运行指定任务。</p><p>目前有两个站点:</p><ol><li><p><code>Travis.org</code> 对于所有<code>public</code>项目完全免费</p></li><li><p><code>Travics.com</code> 只针对<code>private</code>项目，提供更多一些额外功能，如<code>cache</code>，并行<code>build</code>个数</p></li></ol><p>两个站点只能看到各自的项目，不能通用。</p><h1 id="Why-we-need-Travis-CI"><a href="#Why-we-need-Travis-CI" class="headerlink" title="Why we need Travis CI?"></a>Why we need Travis CI?</h1><p>有人可能会有疑问: 在本地写完博客，直接一个命令<code>hexo d</code>，不就搞定了么， 为啥要费力搞<code>CI</code>？</p><p>的确, 想用<code>TravisCI</code>来自动部署Hexo博客程序，需要不少设置（瞎折腾），为了给大伙信心，列举一些优点：</p><div class="note success"><p>优点1：直接在线编辑文件，立即生效</p></div><p>假设你已经发表了一篇文章，过了几天你在朋友机器上浏览发现有几个明显的错别字，对于有强迫症的，这是不能容忍的。 但你手头又没有完整的hexo+nodejs+git的开发环境，重新下载git，node，hexo配置会花费不少时间，特别不划算。</p><p>如果按照这篇完整折腾完，你可以直接用浏览器访问github个人项目仓库，直接编辑那篇post的原md文件，前后2分钟改完。 稍等片刻，你的博客就自动更新了。</p><div class="note success"><p>优点2：自动部署，同时部署到多个地方</p></div><p>在<code>gitcafe</code>是被收购之前，很多同学（包括我）都是托管在上面的，国内访问速度比<code>Github</code>快很多。<br>配合<code>DNS</code>根据<code>IP</code>位置可以自动选择导到<code>gitcafe</code>, 还是<code>github</code>，甚至你还可以部署到七牛云的静态网站。<br>利用<code>Travis CI</code>可同时更新多个仓库。</p><p>比如我的博客现在有两个站：一个部署在码云，一个部署在github。都需要我自己手动部署。</p><p>注：最后发现码云并不支持。emmmmm</p><div class="note success"><p>优点3：部署快捷方便</p></div><p>手动<code>deploy</code>需要推送<code>public</code>整个folder到github上，当后期网站文章、图片较多时候，对于天朝的网络，有时候连接github 就是不顺畅，经常要傻等不少上传时间。<br>有了CI，你可以只提交<code>post</code>文件里单独的<code>md</code>文件即可，很快很爽，谁用谁知道。</p><div class="note success"><p>优点4：bigger than bigger<br>build icon</p></div><p>你的项目<code>Readme</code>里面可以显示<code>CI build</code>图标，很酷有没有？<br>另外通过设置，可以在当<code>build失败</code>时<strong>自动发邮件提醒你。</strong><br>上面的图标，如果登陆后你在Github项目里，直接点击图标，会跳转到你当前项目build的log界面，很方便。</p><p>当然有了<code>CI</code>，你可以做很多事情，如<code>自动运行单元测试</code>，<code>成功后再deploy</code>等等。很多项目里的持续集成基本也是这个道理。</p><h1 id="How-to-use-Travis-CI-to-deploy-hexo-blog"><a href="#How-to-use-Travis-CI-to-deploy-hexo-blog" class="headerlink" title="How to use Travis CI to deploy hexo blog?"></a>How to use Travis CI to deploy hexo blog?</h1><p>原博主是使用private项目演示的，虽然我也就用学校邮箱加入了<code>Github</code>的<code>Education plan</code> 但是为了通用性，我本次做了<code>public</code>的实践。</p><h2 id="步骤："><a href="#步骤：" class="headerlink" title="步骤："></a>步骤：</h2><h3 id="准备Travis-CI账号-传送门：public项目-private项目-在登陆成功后"><a href="#准备Travis-CI账号-传送门：public项目-private项目-在登陆成功后" class="headerlink" title="准备Travis CI账号, 传送门：public项目, private项目, 在登陆成功后."></a>准备Travis CI账号, 传送门：<a href="https://travis-ci.org/" target="_blank" rel="noopener">public项目</a>, <a href="https://travis-ci.com/" target="_blank" rel="noopener">private项目</a>, 在登陆成功后.</h3><p><img src="http://myphoto.mtianyan.cn/blog/180104/A9fAbhaL19.png?imageslim" alt="mark"></p><p>如果发现没有<code>Repositories</code>，点击上图加号会看到自己的目录然后把想要持续集成的仓库开关打开，会自动hook到Github。</p><p><img src="http://myphoto.mtianyan.cn/blog/180105/l1HkKEIcjh.png?imageslim" alt="mark"></p><p>注意: 这里需要打开的是自己的</p><h3 id="准备Github-Personal-Access-Token。"><a href="#准备Github-Personal-Access-Token。" class="headerlink" title="准备Github Personal Access Token。"></a>准备Github Personal Access Token。</h3><p>在Github的setting页面，左侧面板选择<code>Developer settings</code>然后<code>Personal access tokens</code>, 右上角点击<code>Generate new token</code>。生成<code>token</code>时候需要确定<code>访问scope</code>，这里我们选择第一个<code>repo</code>即可。<strong>重要：生成的<code>token</code>只有第一次可见，一定要保存下来备用。</strong></p><p><img src="http://myphoto.mtianyan.cn/blog/180104/k9k94G963L.png?imageslim" alt="mark"></p><h3 id="可选操作：除非你对于Travis-CI保存你的密钥不信任，才需要做，否则可以直接跳过省事"><a href="#可选操作：除非你对于Travis-CI保存你的密钥不信任，才需要做，否则可以直接跳过省事" class="headerlink" title="(可选操作：除非你对于Travis CI保存你的密钥不信任，才需要做，否则可以直接跳过省事)"></a>(可选操作：除非你对于Travis CI保存你的密钥不信任，才需要做，否则可以直接跳过省事)</h3><p>推荐直接跳过：有点奇怪原博主加了密又自行设置了环境变量保存token。加密在最后都没有用到。。。</p><ul><li>准备<a href="https://github.com/travis-ci/travis.rb" target="_blank" rel="noopener">Travis命令行工具</a>，需要依赖ruby环境。对于Windows环境，可以使用这里的<a href="https://rubyinstaller.org/downloads/" target="_blank" rel="noopener">安装包</a>，安装完成后可用<code>ruby -v</code>检查。</li></ul><p>请安装<code>2.4.x</code>版本。</p><p><img src="http://myphoto.mtianyan.cn/blog/180104/3bjG0jfmc4.png?imageslim" alt="mark"></p><p><strong>注意</strong>不要安装<code>2.5</code>版本。暂时不支持。会报错:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR: Error installing travis: The last version of ffi (&gt;= 1.3.0) to support your Ruby &amp; RubyGems was 1.9.18. Try installing it with `gem install ffi -v 1.9.18` and then running the current command again ffi requires Ruby version &lt; 2.5, &gt;= 2.0. The current ruby version is 2.5.0.</span><br></pre></td></tr></table></figure><ul><li>安装命令行工具，参考这里<a href="https://github.com/travis-ci/travis.rb#installation" target="_blank" rel="noopener">官方文档</a>：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install travis</span><br></pre></td></tr></table></figure><p>验证travis安装成功</p><p><img src="http://myphoto.mtianyan.cn/blog/180104/cgGbjIaA75.png?imageslim" alt="mark"></p><ul><li>用Github的用户名/密码登录这个命令行工具。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">travis login</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180104/BGK3J1449G.png?imageslim" alt="mark"></p><p>登陆成功后，开始加密，参考下面代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">travis encrypt -r &lt;github name&gt;/&lt;github repo&gt; GH_Token=XXX</span><br><span class="line"></span><br><span class="line">#sample：</span><br><span class="line">travis encrypt -r mtianyan/hexoBlog-Github GH_TOKEN=33ba3948bxxx</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180104/BcCm1JgH4B.png?imageslim" alt="mark"></p><p>把输出的<code>secure:&quot;xxxx&quot;</code>保存。可以在文件的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">env:</span><br><span class="line"> global:</span><br><span class="line">   - secure: `你加密后的`</span><br></pre></td></tr></table></figure><p><code>travis-ci</code>会自动对于你的密钥进行解密。当做加密前的环境变量:<code>GH_TOKEN</code></p><h3 id="配置-travis-yml（如果没有，新建"><a href="#配置-travis-yml（如果没有，新建" class="headerlink" title="配置.travis.yml（如果没有，新建)"></a>配置<code>.travis.yml</code>（如果没有，新建)</h3><p>添加环境变量来保护自己的github密钥。</p><p><img src="http://myphoto.mtianyan.cn/blog/180105/k5jdFhABe3.png?imageslim" alt="mark"></p><p>点击<code>more options</code> 选择 <code>setting</code>.</p><p><img src="http://myphoto.mtianyan.cn/blog/180105/i8KFECDafl.png?imageslim" alt="mark"></p><p>找到环境变量值。将自己在github得到的<code>个人token值</code> 作为<code>value</code>，<code>name</code>可以自行定义<br><code>Travis_Token</code></p><p><img src="http://myphoto.mtianyan.cn/blog/180105/Gjb2cI7287.png?imageslim" alt="mark"></p><p>下面<code>gulp</code>的压缩安装，参考我Hexo中教程的方法。<br>如果不需要压缩，可自行替换为<code>hexo g</code></p><p>我个人的<code>.travis.yml</code> 可供<a href="https://github.com/mtianyan/hexoBlog-Github/blob/master/.travis.yml" target="_blank" rel="noopener">参考</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">language: node_js  #设置语言</span><br><span class="line"></span><br><span class="line">node_js: stable  #设置相应的版本</span><br><span class="line"></span><br><span class="line">cache:</span><br><span class="line">    apt: true</span><br><span class="line">    directories:</span><br><span class="line">        - node_modules # 缓存不经常更改的内容</span><br><span class="line"></span><br><span class="line">before_install:</span><br><span class="line">    - export TZ=&apos;Asia/Shanghai&apos; # 更改时区</span><br><span class="line"></span><br><span class="line">install:</span><br><span class="line">  - npm install  #安装hexo及插件</span><br><span class="line"></span><br><span class="line">script:</span><br><span class="line">  - hexo clean  #清除</span><br><span class="line">  - hexo g &amp;&amp; gulp  #生成</span><br><span class="line"></span><br><span class="line">after_script:</span><br><span class="line">  - git clone https://$&#123;GH_REF&#125; .deploy_git  # GH_REF是最下面配置的仓库地址</span><br><span class="line">  - cd .deploy_git</span><br><span class="line">  - git checkout master</span><br><span class="line">  - cd ../</span><br><span class="line">  - mv .deploy_git/.git/ ./public/   # 这一步之前的操作是为了保留master分支的提交记录，不然每次git init的话只有1条commit</span><br><span class="line">  - cd ./public</span><br><span class="line">  - git config user.name &quot;mtianyan&quot;  #修改name</span><br><span class="line">  - git config user.email &quot;1147727180@qq.com&quot;  #修改email</span><br><span class="line">  - git add .</span><br><span class="line">  - git commit -m &quot;Travis CI Auto Builder at `date +&quot;%Y-%m-%d %H:%M&quot;`&quot;  # 提交记录包含时间 跟上面更改时区配合</span><br><span class="line">  - git push --force --quiet &quot;https://$&#123;Travis_Token&#125;@$&#123;GH_REF&#125;&quot; master:master  #Travis_Token是在Travis中配置环境变量的名称</span><br><span class="line"></span><br><span class="line">branches:</span><br><span class="line">  only:</span><br><span class="line">    - master  #只监测master分支，master是我的分支的名称，可根据自己情况设置</span><br><span class="line">env:</span><br><span class="line"> global:</span><br><span class="line">   - GH_REF: github.com/mtianyan/mtianyan.github.io.git  #设置GH_REF，注意更改yourname</span><br><span class="line"></span><br><span class="line"># configure notifications (email, IRC, campfire etc)</span><br><span class="line"># please update this section to your needs!</span><br><span class="line"># https://docs.travis-ci.com/user/notifications/</span><br><span class="line">notifications:</span><br><span class="line">  email:</span><br><span class="line">    - 1147727180@qq.com</span><br><span class="line">    - mtianyan@outlook.com</span><br><span class="line">  on_success: change</span><br><span class="line">  on_failure: always</span><br></pre></td></tr></table></figure><p>这里需要注意的是：<code>GH_REF</code>，这个地址其实就是你github上存放<code>静态博客最终文件的仓库地址</code>，末尾加上<code>.git</code>。</p><h3 id="集成build-icon，在Travis-CI控制台里，点击那个icon，选择markdown的样式，然后放到项目Readme里即可。"><a href="#集成build-icon，在Travis-CI控制台里，点击那个icon，选择markdown的样式，然后放到项目Readme里即可。" class="headerlink" title="集成build icon，在Travis CI控制台里，点击那个icon，选择markdown的样式，然后放到项目Readme里即可。"></a>集成<code>build icon</code>，在<code>Travis CI</code>控制台里，点击那个<code>icon</code>，选择<code>markdown</code>的样式，然后放到项目<code>Readme</code>里即可。</h3><p><img src="http://myphoto.mtianyan.cn/blog/180105/bl7HDma64l.png?imageslim" alt="mark"></p><h3 id="大功告成后的使用。"><a href="#大功告成后的使用。" class="headerlink" title="大功告成后的使用。"></a>大功告成后的使用。</h3><p>你可以在本地hexo源码目录内，使用命令:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -am &quot;实验&quot;</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><p>来将自己的博客源码提交至<code>github中的源码仓库</code> CI检测到你的源码更新改动会自动帮你编译<code>git push 到你的静态页面存放仓库</code></p><p><img src="http://myphoto.mtianyan.cn/blog/180105/j9fA5GhEfk.png?imageslim" alt="mark"></p><p>在<code>commit</code>记录中会显示<code>bulid</code>的状态。</p><p>注意：有点慢。毕竟他要在Ci的服务器上根据你的配置文件安装下载，然后使用它的虚拟机进行部署。</p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div><div class="my_post_copyright"><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script><script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script><p><span>本文标题:</span><a href="/post/90a759d5.html">用TravisCI持续集成自动部署Hexo博客的个人实践</a></p><p><span>文章作者:</span><a href="/" title="访问 mtianyan 的个人博客">mtianyan</a></p><p><span>发布时间:</span>2018年01月04日 - 20:01</p><p><span>最后更新:</span>2018年01月17日 - 00:01</p><p><span>原始链接:</span><a href="/post/90a759d5.html" title="用TravisCI持续集成自动部署Hexo博客的个人实践">http://blog.mtianyan.cn/post/90a759d5.html</a><span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://blog.mtianyan.cn/post/90a759d5.html" aria-label="复制成功！"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p></div><script>var clipboard=new Clipboard(".fa-clipboard");$(".fa-clipboard").click(function(){clipboard.on("success",function(){swal({title:"",text:"复制成功",icon:"success",showConfirmButton:!0})})})</script></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>请博主吃包辣条</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.png" alt="mtianyan 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/images/alipay.jpg" alt="mtianyan 支付宝"><p>支付宝</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Hexo/" rel="tag"><i class="fa fa-tag"></i> Hexo</a><a href="/tags/环境搭建/" rel="tag"><i class="fa fa-tag"></i> 环境搭建</a><a href="/tags/TravisCI/" rel="tag"><i class="fa fa-tag"></i> TravisCI</a></div><div class="post-widgets"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/post/aaa76191.html" rel="next" title="Python装饰器-专题笔记"><i class="fa fa-chevron-left"></i> Python装饰器-专题笔记</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/post/deaf66c8.html" rel="prev" title="Python文件处理-专题笔记">Python文件处理-专题笔记<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"> <span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a><a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=2154292" charset="utf-8"></script></div></div></div><div class="comments" id="comments"><div id="SOHUCS"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="mtianyan"><p class="site-author-name" itemprop="name">mtianyan</p><p class="site-description motion-element" itemprop="description">爱分享，爱技术，爱生活。</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">34</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">22</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/mtianyan" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://www.jianshu.com/u/db9a7a0daa1f" target="_blank" title="简书"><i class="fa fa-fw fa-book"></i> 简书</a></span><span class="links-of-author-item"><a href="https://plus.google.com/u/0/114963812195952881148" target="_blank" title="Google"><i class="fa fa-fw fa-google"></i> Google</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://mtianyan.gitee.io/" title="本站孪生站(国内码云托管)" target="_blank">本站孪生站(国内码云托管)</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#What-is-Travis-CI"><span class="nav-number">1.</span> <span class="nav-text">What is Travis CI?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Why-we-need-Travis-CI"><span class="nav-number">2.</span> <span class="nav-text">Why we need Travis CI?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-use-Travis-CI-to-deploy-hexo-blog"><span class="nav-number">3.</span> <span class="nav-text">How to use Travis CI to deploy hexo blog?</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#步骤："><span class="nav-number">3.1.</span> <span class="nav-text">步骤：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#准备Travis-CI账号-传送门：public项目-private项目-在登陆成功后"><span class="nav-number">3.1.1.</span> <span class="nav-text">准备Travis CI账号, 传送门：public项目, private项目, 在登陆成功后.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#准备Github-Personal-Access-Token。"><span class="nav-number">3.1.2.</span> <span class="nav-text">准备Github Personal Access Token。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可选操作：除非你对于Travis-CI保存你的密钥不信任，才需要做，否则可以直接跳过省事"><span class="nav-number">3.1.3.</span> <span class="nav-text">(可选操作：除非你对于Travis CI保存你的密钥不信任，才需要做，否则可以直接跳过省事)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置-travis-yml（如果没有，新建"><span class="nav-number">3.1.4.</span> <span class="nav-text">配置.travis.yml（如果没有，新建)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#集成build-icon，在Travis-CI控制台里，点击那个icon，选择markdown的样式，然后放到项目Readme里即可。"><span class="nav-number">3.1.5.</span> <span class="nav-text">集成build icon，在Travis CI控制台里，点击那个icon，选择markdown的样式，然后放到项目Readme里即可。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#大功告成后的使用。"><span class="nav-number">3.1.6.</span> <span class="nav-text">大功告成后的使用。</span></a></li></ol></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">mtianyan</span><div class="theme-info"><div class="powered-by"></div> <span class="post-count">博客全站共178.0k字</span></div></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script> <span class="site-uv">本站访客数<span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 人次</span> <span class="site-pv">本站总访问量<span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script><script type="text/javascript">!function(){var t="1eb79150519fd9b791c77e8eef6f3632";if((window.innerWidth||document.documentElement.clientWidth)<960)window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=cyrJmJ3rL&conf='+t+'"><\/script>');else{!function(t,e){var n=document.getElementsByTagName("head")[0]||document.head||document.documentElement,a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("charset","UTF-8"),a.setAttribute("src",t),"function"==typeof e&&(window.attachEvent?a.onreadystatechange=function(){var t=a.readyState;"loaded"!==t&&"complete"!==t||(a.onreadystatechange=null,e())}:a.onload=e),n.appendChild(a)}("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:"cyrJmJ3rL",conf:t})})}}()</script><script type="text/javascript" src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script><script type="text/javascript">var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")};function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var r=!1,s=0,a=0,i=n.title.trim(),c=i.toLowerCase(),l=n.content.trim().replace(/<[^>]+>/g,""),h=l.toLowerCase(),p=decodeURIComponent(n.url),u=[],f=[];if(""!=i&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}u=u.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(u.length>0||f.length>0)&&(r=!0,s=u.length+f.length)),r){[u,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});function d(e,o,n,r){for(var s=r[r.length-1],i=s.position,c=s.word,l=[],h=0;i+c.length<=n&&0!=r.length;){c===t&&h++,l.push({position:i,length:c.length});var p=i+c.length;for(r.pop();0!=r.length&&(i=(s=r[r.length-1]).position,c=s.word,p>i);)r.pop()}return a+=h,{hits:l,start:o,end:n,searchTextCount:h}}var g=[];0!=u.length&&g.push(d(0,0,i.length,u));for(var v=[];0!=f.length;){var $=f[f.length-1],C=$.position,m=$.word,x=C-20,w=C+80;x<0&&(x=0),w<C+m.length&&(w=C+m.length),w>l.length&&(w=l.length),v.push(d(0,x,w,f))}v.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var y=parseInt("1");y>=0&&(v=v.slice(0,y));function T(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var b="";0!=g.length?b+="<li><a href='"+p+"' class='search-result-title'>"+T(i,g[0])+"</a>":b+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",v.forEach(function(t){b+="<a href='"+p+'\'><p class="search-result">'+T(l,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:a,hitCount:s,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("2uqmIjYredIvFy6tEXbKG4Fj-gzGzoHsz","CWl1rE8cQlIseOg2Cq3hzxYi")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var i=0;i<e.length;i++){var s=e[i],r=s.get("url"),l=s.get("time"),c=document.getElementById(r);$(c).find(t).text(l)}for(i=0;i<n.length;i++){r=n[i],c=document.getElementById(r);var u=$(c).find(t);""==u.text()&&u.text(0)}}else o.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var s=new e,r=new AV.ACL;r.setPublicReadAccess(!0),r.setPublicWriteAccess(!0),s.setACL(r),s.set("title",o),s.set("url",n),s.set("time",1),s.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={},pbOptions.iconStyle="default",pbOptions.boxForm="horizontal",pbOptions.position="bottomCenter",pbOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={},flOptions.iconStyle="default",flOptions.boxForm="horizontal",flOptions.position="middleRight",flOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-float",flOptions)</script><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script><script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><div id="hexo-helper-live2d"><canvas id="live2dcanvas" width="150" height="300"></canvas></div><style>#live2dcanvas{position:fixed;width:150px;height:300px;opacity:.7;right:-30px;z-index:999;pointer-events:none;bottom:40px}</style><script type="text/javascript" src="/live2d/device.min.js"></script><script type="text/javascript">
const loadScript = function loadScript(c,b){var a=document.createElement("script");a.type="text/javascript";"undefined"!=typeof b&&(a.readyState?a.onreadystatechange=function(){if("loaded"==a.readyState||"complete"==a.readyState)a.onreadystatechange=null,b()}:a.onload=function(){b()});a.src=c;document.body.appendChild(a)};
(function(){
  if((typeof(device) != 'undefined') && (device.mobile())){
    var trElement = document.getElementById('hexo-helper-live2d');
    trElement.parentNode.removeChild(trElement);
    return;
  }else
    if (typeof(device) === 'undefined') console.error('Cannot find current-device script.');
  loadScript("/live2d/script.js", function(){loadlive2d("live2dcanvas", "/live2d/assets/hijiki.model.json", 0.5);});
})();
</script></body></html><script type="text/javascript" src="/js/src/love.js"></script>